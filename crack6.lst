     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [BITS 32]
     4 00000000                                 [FILE "crack7.nas"]
     5 00000000                                 
     6 00000000                                 		GLOBAL	_Main
     7 00000000                                 	
     8                                          [SECTION .text]
     9 00000000                                 
    10 00000000                                 _Main:
    11 00000000 66 B8 1F68                      		MOV		AX,1005*8
    12 00000004 8E D8                           		MOV		DS,AX						;攻击段号1005（第一个命令行窗口的应用程序代码段）
    13 00000006 3E 81 3D 00000004 69726148      		CMP		DWORD [DS:0x0004], 'Hari'	; 判断是否为应用程序
    14 00000011 75 19                           		JNE		fin							; 不是应用程序不进行攻击
    15 00000013                                 		
    16 00000013 3E 8B 0D 00000000               		MOV		ECX,[DS:0x0000]				; 读取应用程序数据段的大小
    17 0000001A 66 B8 3EA8                      		MOV		AX, 2005*8
    18 0000001E 8E D8                           		MOV		DS,AX						; 切换到段号2005
    19 00000020                                 		
    20 00000020                                 crackloop:									; 循环将其中的所有内容替换为无效内容123
    21 00000020 83 C1 FF                        		ADD		ECX,-1
    22 00000023 3E C6 01 7B                     		MOV		BYTE [DS:ECX], 123
    23 00000027 83 F9 00                        		CMP		ECX,0
    24 0000002A 75 F4                           		JNE		crackloop
    25 0000002C                                 
    26 0000002C                                 fin:
    27 0000002C BA 00000004                     		MOV		EDX,4
    28 00000031 CD 40                           		INT		0x40
