     1 00000000                                 [FORMAT "WCOFF"]				; 生成对象文件的模式
     2 00000000                                 [INSTRSET "i486p"]				; 使用486兼容指令集
     3 00000000                                 [BITS 32]						; 生成32为模式机器语言
     4 00000000                                 [FILE "helloCFunc.nas"]			; 源文件名信息
     5 00000000                                 
     6 00000000                                 		GLOBAL	_apiPutchar, _apiPutstr0, _apiOpenWindow, _apiPutStrWin, _apiBoxFillWin, _apiInitMalloc, _apiMalloc, _apiFree
     7 00000000                                 		GLOBAL	_apiAllocTimer, _apiInitTimer, _apiSetTimer, _apiFreeTimer, _apiBeep
     8 00000000                                 		GLOBAL	_apiGetKey, _apiCloseWin, _apiLineWin, _apiPoint, _apiEnd, _apiRefreshWin
     9 00000000                                 		
    10                                          [SECTION .text]
    11 00000000                                 
    12 00000000                                 _apiPutchar:					; void apiPutchar(int c)
    13 00000000 BA 00000001                     		MOV		EDX,1			; 功能号1
    14 00000005 8A 44 24 04                     		MOV		AL,[ESP+4]		; c
    15 00000009 CD 40                           		INT		0x40
    16 0000000B C3                              		RET
    17 0000000C                                 		
    18 0000000C                                 _apiPutstr0:					; void apiPutstr0(char *s)
    19 0000000C 53                              		PUSH	EBX
    20 0000000D BA 00000002                     		MOV		EDX,2
    21 00000012 8B 5C 24 08                     		MOV		EBX,[ESP+8]		; s
    22 00000016 CD 40                           		INT		0x40
    23 00000018 5B                              		POP		EBX
    24 00000019 C3                              		RET
    25 0000001A                                 		
    26 0000001A                                 _apiOpenWindow:					; int apiOpenWindow(char *buf, int width, int height, int colInvNum, char *title);
    27 0000001A 57                              		PUSH	EDI
    28 0000001B 56                              		PUSH	ESI
    29 0000001C 53                              		PUSH	EBX
    30 0000001D BA 00000005                     		MOV		EDX,5			; 功能号5打印窗口
    31 00000022 8B 5C 24 10                     		MOV		EBX,[ESP+16]	; buf
    32 00000026 8B 74 24 14                     		MOV		ESI,[ESP+20]	; width
    33 0000002A 8B 7C 24 18                     		MOV		EDI,[ESP+24]	; height
    34 0000002E 8B 44 24 1C                     		MOV		EAX,[ESP+28]	; colInvNum
    35 00000032 8B 4C 24 20                     		MOV		ECX,[ESP+32]	; title
    36 00000036 CD 40                           		INT		0x40
    37 00000038 5B                              		POP		EBX
    38 00000039 5E                              		POP		ESI
    39 0000003A 5F                              		POP		EDI
    40 0000003B C3                              		RET
    41 0000003C                                 		
    42 0000003C                                 _apiPutStrWin:					; void apiPutStrWin(int win, int x, int y, int col, int len, char *str);
    43 0000003C 57                              		PUSH	EDI
    44 0000003D 56                              		PUSH	ESI
    45 0000003E 55                              		PUSH	EBP
    46 0000003F 53                              		PUSH	EBX
    47 00000040 BA 00000006                     		MOV		EDX,6			; 功能号6
    48 00000045 8B 5C 24 14                     		MOV		EBX,[ESP+20]	; win 图层句柄
    49 00000049 8B 74 24 18                     		MOV		ESI,[ESP+24]	; x
    50 0000004D 8B 7C 24 1C                     		MOV		EDI,[ESP+28]	; y
    51 00000051 8B 44 24 20                     		MOV		EAX,[ESP+32]	; col
    52 00000055 8B 4C 24 24                     		MOV		ECX,[ESP+36]	; len
    53 00000059 8B 6C 24 28                     		MOV		EBP,[ESP+40]	; str
    54 0000005D CD 40                           		INT		0x40
    55 0000005F 5B                              		POP		EBX
    56 00000060 5D                              		POP		EBP
    57 00000061 5E                              		POP		ESI
    58 00000062 5F                              		POP		EDI
    59 00000063 C3                              		RET
    60 00000064                                 		
    61 00000064                                 _apiBoxFillWin:					; void apiBoxFillWin(int win, int startX, int startY, int endX, int endY, int col);
    62 00000064 57                              		PUSH	EDI
    63 00000065 56                              		PUSH	ESI
    64 00000066 55                              		PUSH	EBP
    65 00000067 53                              		PUSH	EBX
    66 00000068 BA 00000007                     		MOV		EDX,7			; 功能号7
    67 0000006D 8B 5C 24 14                     		MOV		EBX,[ESP+20]	; win 图层句柄
    68 00000071 8B 44 24 18                     		MOV		EAX,[ESP+24]	; startX
    69 00000075 8B 4C 24 1C                     		MOV		ECX,[ESP+28]	; startY
    70 00000079 8B 74 24 20                     		MOV		ESI,[ESP+32]	; endX
    71 0000007D 8B 7C 24 24                     		MOV		EDI,[ESP+36]	; endY
    72 00000081 8B 6C 24 28                     		MOV		EBP,[ESP+40]	; col
    73 00000085 CD 40                           		INT		0x40
    74 00000087 5B                              		POP		EBX
    75 00000088 5D                              		POP		EBP
    76 00000089 5E                              		POP		ESI
    77 0000008A 5F                              		POP		EDI
    78 0000008B C3                              		RET
    79 0000008C                                 		
    80 0000008C                                 _apiInitMalloc:					; void apiInitMalloc();
    81 0000008C 53                              		PUSH	EBX
    82 0000008D BA 00000008                     		MOV		EDX,8			; 功能号8
    83 00000092 2E 8B 1D 00000020               		MOV		EBX,[CS:0x0020]	; 在应用程序文件中读取0x0020位置记录的当前malloc可分配内存空间起始地址（memsegtable管理空间起始地址）
    84 00000099 89 D8                           		MOV		EAX,EBX
    85 0000009B 05 00008000                     		ADD		EAX,32*1024		; 加上32KB
    86 000000A0 2E 8B 0D 00000000               		MOV		ECX,[CS:0x0000]	; 在应用程序文件中读取0x0000位置读取数据段的大小（memsegtable管理的字节数）
    87 000000A7 29 C1                           		SUB		ECX,EAX
    88 000000A9 CD 40                           		INT		0x40
    89 000000AB 5B                              		POP		EBX
    90 000000AC C3                              		RET
    91 000000AD                                 
    92 000000AD                                 _apiMalloc:						; char *apiMalloc(int size);
    93 000000AD 53                              		PUSH	EBX
    94 000000AE BA 00000009                     		MOV		EDX,9			; 功能号9
    95 000000B3 2E 8B 1D 00000020               		MOV		EBX,[CS:0x0020]
    96 000000BA 8B 4C 24 08                     		MOV		ECX,[ESP+8]		; size
    97 000000BE CD 40                           		INT		0x40
    98 000000C0 5B                              		POP		EBX
    99 000000C1 C3                              		RET
   100 000000C2                                 		
   101 000000C2                                 _apiFree:						; void apiFree(char *addr, int size);
   102 000000C2 53                              		PUSH	EBX
   103 000000C3 BA 0000000A                     		MOV		EDX,10			; 功能号10
   104 000000C8 2E 8B 1D 00000020               		MOV		EBX,[CS:0x0020]
   105 000000CF 8B 44 24 08                     		MOV		EAX,[ESP+8]		; addr
   106 000000D3 8B 4C 24 0C                     		MOV		ECX,[ESP+12]	; size
   107 000000D7 CD 40                           		INT		0x40
   108 000000D9 5B                              		POP		EBX
   109 000000DA C3                              		RET
   110 000000DB                                 		
   111 000000DB                                 _apiPoint:						; void apiPoint(int sheet, int x, int y, int col);
   112 000000DB 57                              		PUSH	EDI
   113 000000DC 56                              		PUSH	ESI
   114 000000DD 53                              		PUSH	EBX
   115 000000DE BA 0000000B                     		MOV		EDX,11			; 功能号11
   116 000000E3 8B 5C 24 10                     		MOV		EBX,[ESP+16]	; sheet图层句柄
   117 000000E7 8B 74 24 14                     		MOV		ESI,[ESP+20]	; x
   118 000000EB 8B 7C 24 18                     		MOV		EDI,[ESP+24]	; y
   119 000000EF 8B 44 24 1C                     		MOV		EAX,[ESP+28]	; col
   120 000000F3 CD 40                           		INT		0x40
   121 000000F5 5B                              		POP		EBX
   122 000000F6 5E                              		POP		ESI
   123 000000F7 5F                              		POP		EDI
   124 000000F8 C3                              		RET
   125 000000F9                                 
   126 000000F9                                 _apiRefreshWin:					; void apiRefreshWin(int sheet, int startX, int startY, int endX, int endY);
   127 000000F9 57                              		PUSH	EDI
   128 000000FA 56                              		PUSH	ESI
   129 000000FB 53                              		PUSH	EBX
   130 000000FC BA 0000000C                     		MOV		EDX,12			; 功能号12
   131 00000101 8B 5C 24 10                     		MOV		EBX,[ESP+16]	; sheet 图层句柄
   132 00000105 8B 44 24 14                     		MOV		EAX,[ESP+20]	; startX
   133 00000109 8B 4C 24 18                     		MOV		ECX,[ESP+24]	; startY
   134 0000010D 8B 74 24 1C                     		MOV		ESI,[ESP+28]	; endX
   135 00000111 8B 7C 24 20                     		MOV		EDI,[ESP+32]	; endY
   136 00000115 CD 40                           		INT		0x40
   137 00000117 5B                              		POP		EBX
   138 00000118 5E                              		POP		ESI
   139 00000119 5F                              		POP		EDI
   140 0000011A C3                              		RET
   141 0000011B                                 		
   142 0000011B                                 _apiLineWin:					; void apiLineWin(int sheet, int startX, int startY, int endX, int endY, int col);
   143 0000011B 57                              		PUSH	EDI
   144 0000011C 56                              		PUSH	ESI
   145 0000011D 55                              		PUSH	EBP
   146 0000011E 53                              		PUSH	EBX
   147 0000011F BA 0000000D                     		MOV		EDX,13			; 功能号13
   148 00000124 8B 5C 24 14                     		MOV		EBX,[ESP+20]	; sheet
   149 00000128 8B 44 24 18                     		MOV		EAX,[ESP+24]	; startX
   150 0000012C 8B 4C 24 1C                     		MOV		ECX,[ESP+28]	; startY
   151 00000130 8B 74 24 20                     		MOV		ESI,[ESP+32]	; endX
   152 00000134 8B 7C 24 24                     		MOV		EDI,[ESP+36]	; endY
   153 00000138 8B 6C 24 28                     		MOV		EBP,[ESP+40]	; col
   154 0000013C CD 40                           		INT		0x40
   155 0000013E 5B                              		POP		EBX
   156 0000013F 5D                              		POP		EBP
   157 00000140 5E                              		POP		ESI
   158 00000141 5F                              		POP		EDI
   159 00000142 C3                              		RET
   160 00000143                                 		
   161 00000143                                 _apiCloseWin:					; void apiCloseWin(int sheet);
   162 00000143 53                              		PUSH	EBX
   163 00000144 BA 0000000E                     		MOV		EDX,14			; 功能号14
   164 00000149 8B 5C 24 08                     		MOV		EBX,[ESP+8]		; sheet
   165 0000014D CD 40                           		INT		0x40
   166 0000014F 5B                              		POP		EBX
   167 00000150 C3                              		RET
   168 00000151                                 		
   169 00000151                                 _apiGetKey:						; int apiGetKey(int mode);
   170 00000151 BA 0000000F                     		MOV		EDX,15
   171 00000156 8B 44 24 04                     		MOV		EAX,[ESP+4]		; mode
   172 0000015A CD 40                           		INT		0x40
   173 0000015C C3                              		RET
   174 0000015D                                 
   175 0000015D                                 _apiAllocTimer:					; int apiAllocTimer();
   176 0000015D BA 00000010                     		MOV		EDX,16			; 功能号16
   177 00000162 CD 40                           		INT		0x40
   178 00000164 C3                              		RET
   179 00000165                                 		
   180 00000165                                 _apiInitTimer:					; void apiInitTimer(int timer, int data);
   181 00000165 53                              		PUSH	EBX
   182 00000166 BA 00000011                     		MOV		EDX,17			; 功能号17
   183 0000016B 8B 5C 24 08                     		MOV		EBX,[ESP+8]		; timer
   184 0000016F 8B 44 24 0C                     		MOV		EAX,[ESP+12]	; data
   185 00000173 CD 40                           		INT		0x40
   186 00000175 5B                              		POP		EBX
   187 00000176 C3                              		RET
   188 00000177                                 		
   189 00000177                                 _apiSetTimer:					; void apiSetTimer(int timer, int time);
   190 00000177 53                              		PUSH	EBX
   191 00000178 BA 00000012                     		MOV		EDX,18			; 功能号18
   192 0000017D 8B 5C 24 08                     		MOV		EBX,[ESP+8]		; timer
   193 00000181 8B 44 24 0C                     		MOV		EAX,[ESP+12]	; time
   194 00000185 CD 40                           		INT		0x40
   195 00000187 5B                              		POP		EBX
   196 00000188 C3                              		RET
   197 00000189                                 
   198 00000189                                 _apiFreeTimer:					; void apiFreeTimer(int timer);
   199 00000189 53                              		PUSH	EBX
   200 0000018A BA 00000013                     		MOV		EDX,19			; 功能号19
   201 0000018F 8B 5C 24 08                     		MOV		EBX,[ESP+8]		; timer
   202 00000193 CD 40                           		INT		0x40
   203 00000195 5B                              		POP		EBX
   204 00000196 C3                              		RET
   205 00000197                                 		
   206 00000197                                 _apiBeep:						; void apiBeep(int tone);
   207 00000197 BA 00000014                     		MOV		EDX,20			; 功能号20
   208 0000019C 8B 44 24 04                     		MOV		EAX,[ESP+4]		; tone
   209 000001A0 CD 40                           		INT		0x40
   210 000001A2 C3                              		RET
   211 000001A3                                 
   212 000001A3                                 _apiEnd:						; void apiEnd()
   213 000001A3 BA 00000004                     		MOV		EDX,4
   214 000001A8 CD 40                           		INT		0x40
